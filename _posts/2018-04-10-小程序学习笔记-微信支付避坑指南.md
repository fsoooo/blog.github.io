## 小程序接入微信支付避坑指南

微信支付的整体申请流程，一图以蔽之。

![img](http://upload-images.jianshu.io/upload_images/6943526-f91606a85546feea?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

### 微信支付申请流程

容易掉坑的地方集中在「登记商户资料」—「平台审核资料」的环节。

大部分企业在第一次申请微信支付时，并不能事先了解不同的类目（结算周期）会对应有不同的商户号能力，一旦注册下来之后，发现完全和自己的业务、或者资金管理要求无法匹配的，只能放弃，然后再重新申请，浪费了很多时间。

下面有四个在申请过程中会出现问题的地方，会少走很多弯路。

#### 一.企业付款到零钱

「企业付款到零钱」是指当用户发起提现或退款操作时，从企业的微信支付商户账户中支付对应金额至用户的零钱（钱包）。

常见问题：为什么我的商户号没有付款到零钱的能力？

如果你的业务场景有「提现」、「退款」等需要从企业端付款至用户零钱的操作，那就需要申请带有「企业付款到零钱」能力的商户号，否则，是无法完成上述业务操作。

然而，并不是所有的商户号都会自带「企业付款到零钱」的能力，这就是给初次注册商户号的企业带来了麻烦。

![img](http://upload-images.jianshu.io/upload_images/6943526-fec5a41fe7c48a4d?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

有「企业付款到零钱」的商户号，最好打开你的微信支付商户后台确认下，是不是有「企业付款到零钱」的能力。如果在「产品中心」—「我的产品」中没有这一项，那就是不具备「企业付款到零钱」能力了。

**避坑经验**

1. 申请带「企业付款到零钱」能力的商户号，必须选择结算周期为「非 T+0」 的类目，否则需要满足两个条件：入驻满90天，连续正常交易30天。

2. 如果已经申请的商户号没有「企业付款到零钱」能力，现实条件又不允许再申请的情况下，那就按90—30操作（公司内部养号），直到获得该能力吧。

![img](http://upload-images.jianshu.io/upload_images/6943526-3ee7e827a9abca98?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

「企业付款到零钱」能力开通的条件

3. 我们之前申请过一个没有「企业付款到零钱」能力的商户号，后来内部拉了一个微信群（方便同事提醒）每天保证完成一笔微信支付，在接近30天正常交易之后（大概是二十多天，没有到30天），就在「产品中心」看到这个功能了。（入驻时间达到90天）

如果你们也在等这个功能，可以将下面的链接复制到地址栏打开，来测试「企业付款到零钱」是否达到开通条件（需提前登录商户号）：

https://pay.weixin.qq.com/index.php/public/product/detail?pid=5&productType=0%0A

![img](http://upload-images.jianshu.io/upload_images/6943526-46f5a7315495ab37?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

浏览器地址栏粘贴上述链接即可查看

#### 二. 自动提现

所谓自动提现，即微信支付平台会按签约的结算周期（T+N）和费率，将上一个结算周期的余额（收款）自动划款到公司的银行帐户，这个看似合乎规范的财务流程，遇到实际业务时就会出现问题。

![img](http://upload-images.jianshu.io/upload_images/6943526-6f793bd4a36af55f?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

有「自动提现」的商户号

![img](http://upload-images.jianshu.io/upload_images/6943526-0a03cf205162d837?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

没有「自动提现」的商户号

常见问题：没法关闭「自动提现」，平台没钱了怎么整？

当用户进行提现或退款时，一旦请求的金额大于微信支付平台账户余额的话，是无法完成业务操作的，这会影响到前端用户的使用体验，甚至是产品的核心流程。

导致这个情况的原因是，微信支付商户平台的资金会默认按签约的结算周期将平台收到的钱划到公司银行账户，如果没有通过「自动提现」功能来预留资金在平台（关闭自动提现），那就会出无法完成提现或退款的操作。

但是，坑爹的地方在于，并不是所有的商户号都有「自动提现」能力，如果没有这个能力，那么你是无法关闭「自动提现」的，所以在申请的环节就需要留意选择对应的类目了。

![img](http://upload-images.jianshu.io/upload_images/6943526-0185a324670e2f7f?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

微信支付平台资金自动提现流程

**避坑经验**

1. 「自动提现」能力与注册商户号时所选择的类目有关，具体来说是「结算周期」这个因素，如果你注册的是「T+0」（即时结算）的类目，是可以获得「自动提现」能力的，也就可以关闭「自动提现」这个功能。（要先获得能力，才可以关闭对应的功能）关闭之后，平台的钱就不会再自动跑到企业银行账户了，这样就可以在平台预留资金，以供用户提现或退款时使用了。

关闭「自动提现」以后，还是可以通过手动提现来进行提现的。

2. 如果确认你的商户号没有「自动提现」能力，可以向这个商户号进行充值，已满足提现或退款的业务需求。

#### 三.小程序与商户号的绑定

接入微信支付能力，有两种方式：一是从服务号 / 小程序后台发起微信支付的申请，申请完成即实现了绑定；二是将已有的商户号与已有的服务号 / 小程序进行绑定。

常见问题：小程序和微信支付商户号一旦绑定，就没法解绑了吗？

是的，一旦绑定是不可解绑的。针对此问题，我们还信誓旦旦质问过客服，联系上客服，他们很客气地回复说：对不起，一旦绑定是无法解绑的，建议你们重新注册一个小程序……

![img](http://upload-images.jianshu.io/upload_images/6943526-a50faf07662ef7a2?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

商户号绑定小程序规则

**避坑经验**

1. 在打算接入微信支付前，仔细阅读上述红框内的说明，不管是注册新的还是绑定已有的商户号都需要根据自有业务来做判断，切忌随意绑定。

2. 一个商户号是可以绑定多个APPID的（即多个小程序、公众号），但要确保二者的主体一致。

3. 主体不一致时，虽有特殊授权审核渠道，但请不要抱太大希望，亲测几乎无效。

#### 四.多开申请

什么是多开？多开是指同一个公司主体在同一时间内发起了两个以上的商户号申请订单，这个会几乎 100% 审核被拒。

![img](http://upload-images.jianshu.io/upload_images/6943526-f4a5db64af5094f3?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

因多开而被审核拒

这种情况的发生，很可能是你和其他同事没有同步进度，大家都在同一时间发起了申请；或者是第一次用小程序（A）申请审核被拒，然后想着我换另外一个服务号（B）来发起申请。可能是抱着侥幸的心理，觉得一条路走不通，我换一条，结果还是不可行的，微信支付会对这类「多开」的情况，审核得比较严格。

![img](http://upload-images.jianshu.io/upload_images/6943526-2312afb713983fe5?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

提交补充材料的要求

前几次，我们都是凭着自己想象在写「多开说明」（补充材料），反复被拒了 6 次，后来找到了这个「补充材料」填写说明，对照实际情况如实填写了一份，最后终于通过了。

## 小结

**申请**

1. 申请接入微信支付前需了解业务需求：是否需要「企业付款到零钱」、「自动提现」的能力，从开通条件来看，这两种能力是互斥的，我们的建议是，根据你的业务需求重要程度来判断，如果必须有资金预留（即「自动提现」）能力，那就申请「T+0」结算周期的类目。如果业务必须支持用户在服务号、小程序端可以提现或退款操作的话，那就优先申请「企业付款到零钱」。

![img](http://upload-images.jianshu.io/upload_images/6943526-2f516257536deb9e?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

2. 「自动提现」是只能根据申请的类目来获得的能力，而「企业付款到零钱」我们可以通过后续的操作获得。

3. 95017客服电话还是可以打通的，有一些关键的问题，咨询官方会比自己瞎猜或者侥幸试探要高效很多。

4. 留意用户投诉

如果你的产品业务存在一些投诉风险，请每天留意微信支付商户后台「账户中心」—「消费者投诉」栏目的投诉记录，平台会根据投诉量及投诉内容触发警告机制，限定时间内不予处理，则会收到对商户号进行延长结算周期延长、提高结算费率、封停等不同程度的处理。

5. 商户数据助手

作为老板，你需要每天查看店铺的收入支出情况，微信支付提供了一个方便的小程序，绑定后即可查看商户的完整数据情况，非常方便。

**服务商**

1. 服务商开通的特约商户和普通商户相比较而言，在用户端是没有感知的，只是支付流程服务商会多了一个中间环节。

2. 相比于普通商户，服务商可以快速的开通子商户（也叫特约商户）用于支付业务，一般的审核时间也短很多。

3. 子商户（特约商户）只有支付能力，其他的比如「企业付款到零钱」、「自动提现」等能力都是没有的，适合线下商家；如果是做线上业务，建议还是申请普通商户吧。

**常见问题**

1. 我的产品（小程序/服务号）还没上线，申请微信支付时必须要有内容怎么办？

![img](http://upload-images.jianshu.io/upload_images/6943526-c228cf4c87281ccc?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

这个是我们在申请时常见的提示，不要紧张，如果你的产品还没上线，此处可以先填入你的产品名称，即小程序名称或公众号名称。

同时在下方「产品界面 / 使用场景截图」处提供2-3张图片，如果产品没有上线，那就用原型设计图也行的，实在没有，就用墨刀现画几个带支付业务的页面就可以了。

2. 支付后的关注，在哪里可以设置？

![img](http://upload-images.jianshu.io/upload_images/6943526-5624ed7896d3fa85?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

支付后关注的设置

微信支付总共有七种类型，其中与公众号直接相关拥有支付后「默认关注」功能的，是公众号支付、刷卡支付、扫码支付以及小程序支付这四种。

其中「公众号支付」、「刷卡支付」和「扫码支付」这三类推荐关注的复选框都是默认勾选的，也就是顾客支付成功后自动关注服务号。

但同时微信团队应该是考虑到用户体验，所以对这项功能作出了一定的克制，附加了不默认关注的规定。如下：

1. 公众号支付和扫码支付交消费额低于 5 元不推荐关注；

2. 已经关注的不再展示推荐；

3. 服务号未设置头像的在 iOS 系统不展示推荐关注；

4. 用户取消过关注的，支付页面会展示推荐关注但不默认勾选；

5. 对于粉丝数大于 50w 的公众号，支付成功后不默认勾选关注。

而「小程序支付」则比较特别，跟其他支付有个明显区别，那就是推荐关注的复选框是默认不勾选。这是微信团队坚持小程序「不打扰」原则的体现，把选择权交给用户。
